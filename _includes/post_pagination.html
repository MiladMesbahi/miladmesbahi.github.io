{% include base_path %}

{% comment %}
Portfolio: paginate within the same category (sorted by `order`).
Fallback: normal prev/next for posts/pages.
{% endcomment %}

{% if page.collection == 'portfolio' and page.category %}
  {% assign cat = page.category %}
  {% assign items = site.portfolio | where: "category", cat | sort: "order" %}

  {% assign prev_item = nil %}
  {% assign next_item = nil %}
  {% assign found = false %}

  {% for item in items %}
    {% if found and next_item == nil %}
      {% assign next_item = item %}
    {% endif %}

    {% comment %}
    Use `id` when available (most reliable for collections).
    Fallback to URL match.
    {% endcomment %}
    {% if item.id and page.id %}
      {% if item.id == page.id %}
        {% assign found = true %}
      {% endif %}
    {% else %}
      {% if item.url == page.url %}
        {% assign found = true %}
      {% endif %}
    {% endif %}

    {% if found == false %}
      {% assign prev_item = item %}
    {% endif %}
  {% endfor %}

  {% if prev_item or next_item %}
    <nav class="pagination">
      {% if prev_item %}
        <a href="{{ prev_item.url | relative_url }}" class="pagination--pager"
           title="{{ prev_item.title | markdownify | strip_html }}">
          {{ site.data.ui-text[site.locale].pagination_previous | default: "Previous" }}
        </a>
      {% else %}
        <span class="pagination--pager disabled">
          {{ site.data.ui-text[site.locale].pagination_previous | default: "Previous" }}
        </span>
      {% endif %}

      {% if next_item %}
        <a href="{{ next_item.url | relative_url }}" class="pagination--pager"
           title="{{ next_item.title | markdownify | strip_html }}">
          {{ site.data.ui-text[site.locale].pagination_next | default: "Next" }}
        </a>
      {% else %}
        <span class="pagination--pager disabled">
          {{ site.data.ui-text[site.locale].pagination_next | default: "Next" }}
        </span>
      {% endif %}
    </nav>
  {% endif %}

{% else %}

  {% if page.previous or page.next %}
    <nav class="pagination">
      {% if page.previous %}
        <a href="{{ page.previous.url | relative_url }}" class="pagination--pager"
           title="{{ page.previous.title | markdownify | strip_html }}">
          {{ site.data.ui-text[site.locale].pagination_previous | default: "Previous" }}
        </a>
      {% else %}
        <span class="pagination--pager disabled">
          {{ site.data.ui-text[site.locale].pagination_previous | default: "Previous" }}
        </span>
      {% endif %}

      {% if page.next %}
        <a href="{{ page.next.url | relative_url }}" class="pagination--pager"
           title="{{ page.next.title | markdownify | strip_html }}">
          {{ site.data.ui-text[site.locale].pagination_next | default: "Next" }}
        </a>
      {% else %}
        <span class="pagination--pager disabled">
          {{ site.data.ui-text[site.locale].pagination_next | default: "Next" }}
        </span>
      {% endif %}
    </nav>
  {% endif %}

{% endif %}
